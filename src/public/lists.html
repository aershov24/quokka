<!-- index.html -->
<!doctype html>

<!-- ASSIGN OUR ANGULAR MODULE -->
<html ng-app="quokka">
<head>
    <!-- META -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Optimize mobile viewport -->

    <title>Quokka</title>

    <!-- SCROLLS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous"><!-- load bootstrap -->
	<link rel="stylesheet" href="./css/ng-tags-input.min.css">
	<link rel="stylesheet" href="./css/ng-tags-input.bootstrap.min.css">
	<link rel="stylesheet" href="./css/sticky-footer-navbar.css">
	<link rel="stylesheet" href="./css/style.css">

    <!-- SPELLS -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><!-- load jquery -->
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script><!-- load angular -->
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<script src="./libs/Sortable.min.js"></script>
	<script src="./libs/ng-sortable.js"></script>
	<script src="./libs/ng-tags-input.min.js"></script>
	<script src="./libs/quokka.js"></script>
	<script src="./libs/ui-bootstrap.js"></script>

</head>
<body ng-controller="quokkaController">
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
	  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span> 
      </button>
      <a class="navbar-brand" href="#">Quokka</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li class="active"><a href="/"><span class="glyphicon glyphicon-list"></span> Lists</a></li>
        <li><a href="/bookmarks"><span class="glyphicon glyphicon-bookmark"></span> Bookmarks</a></li>
        <li><a href="/search"><span class="glyphicon glyphicon-search"></span> Search</a></li> 
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/profile">
        	<img width="25px" ng-src="http://graph.facebook.com/{{profile.facebookId}}/picture?type=square" class="img-circle"> {{profile.email}}</a></li>
        <li><a href="/users/logout"><span class="glyphicon glyphicon-log-in"></span> Logout</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="container">
<table width="100%">
	<tr>
		<td valign="bottom"><h2 style="
    margin-top: 0px;
    margin-bottom: 0px;">My Tops</h2></td>
		<td align="right"><button type="submit" class="btn btn-success btn-md" data-ng-click="openAddList()" data-toggle="modal" data-target="#addListForm">Add List</button></td>
	</tr>
</table>
<div id="list-form" class="row">
		<div class="col-sm-12">
			<form>
			<table width="100%">
				<tr>
					<td width="100%"></td>
					<td align="right" 
					style="padding-left: 10px;">
					</td>
				</tr>
			</table>
			</form>
		</div>
	</div>
</br>
<div class="panel-group">
	  <div class="panel panel-default" data-ng-repeat="list in lists">
		<div class="panel-heading">
		  <h4 class="panel-title">
		   <div class="row">
            <table style="width: 100%">
                <tr>
                    <td align="left">
                        <div class="col-md-12">
                            <a data-toggle="collapse" data-ng-hide="list.editMode" href="#collapse{{list._id}}"><b>{{ list.title }}</b></a>
                            <input  class="form-control input-md" data-ng-show="list.editMode" type="text" data-ng-model="list.title" />
                        </div>
                    </td>
                    <td align="right">
                        <div class="col-md-12">
                        <table>
                            <tr>
                            	<td>
                            		<div data-ng-hide="list.editMode" class="dropdown">
							          	<a class="listLink"  href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-cog"></span></a>
								          <ul class="dropdown-menu dropdown-menu-right">
								          	<!-- data-ng-click="toggleEdit(list)" -->
								            <li><a data-ng-click="openEditList(list)" data-toggle="modal" data-target="#editListForm">Edit</a></li>
								            <li><a href="javascript:;" data-ng-click="share(list)">Share</a></li>
								            <li role="separator" class="divider"></li>
								            <li><a href="javascript:;" data-ng-click="deleteList(list._id)">Delete</a></li>
								          </ul>
							      	</div>
							      	<div data-ng-show="list.editMode" class="dropdown">
							          	<a class="listLink"  href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-pencil"></span></a>
								          <ul class="dropdown-menu dropdown-menu-right">
								            <li><a data-ng-click="saveList(list)" href="javascript:;">Save</a></li>
					          				<li><a data-ng-click="toggleEdit(list)" href="javascript:;">Cancel</a></li>
								          </ul>
							      	</div>
                            	</td>
                            	<td>
                            		&nbsp;
                            	</td>
                            	<td>
                            		<a class="listLink" data-toggle="collapse" href="#collapse{{list._id}}"><span class="glyphicon glyphicon-tasks"></span></a>
                            	</td>
                            </tr>
                        </table>
                        </div>
                    </td>
                </tr>
            </table>
            </div>
		  </h4>
		</div>
		<div id="collapse{{list._id}}" class="panel-collapse collapse">
			<div class="panel panel-default">
				<div class="panel-body">
				<p><em>{{list.description}}</em></p>
					<div class="panel-body" style="padding-top: 0px;">
						<!-- FORM TO CREATE LIST -->
						<div id="list-form" class="row">
						<div class="col-sm-12" style="padding-left: 0px; padding-right: 0px;">
							<form name="addItem" role="form" novalidate>
								<table width="100%" valign="top">
								<tr>
								<td width="100%">
									<input name="title" type="text" class="form-control input-md" placeholder="New item" ng-model="newListItem.title"
									ng-minlength="4" ng-maxlength="50" required
									>
									 <small class="error" 
					            		ng-show="addItem.title.$error.minlength && addItem.title.$dirty">
					            		Title is required to be at least 4 characters
					    			</small>
								    <small class="error" 
								            ng-show="addItem.title.$error.maxlength && addItem.title.$dirty">
								            Title cannot be longer than 50 characters
								    </small>
								</td>
								<td  align="right" style="vertical-align:top; padding-left: 10px;">
									<button ng-disabled="addItem.$invalid" type="submit" class="btn btn-success btn-md" ng-click="createListItem(list)">Add Item</button>
								</td>
								</tr>
								</table>
							</form>
						</div>
						</div>
					</div>
					
					<div class="top5">
					<ul class="list-group" ng-sortable="sortConfig" 
					style="margin-bottom: 0px;">
					<li class="list-group-item" data-ng-repeat="item in list.items | orderBy: 'orderId'" >
						<table>
							<tr>
								<td align="left">
									<span class="my-handle"><span class="glyphicon glyphicon-option-horizontal">&nbsp;</span></span>
								</td>
								<td width="100%" align="left">
									{{item.title}}
								</td>
								<td align="right">
									<div class="dropdown">
									<a class="listLink" class="listLink"  href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-edit"></span></a>
									<ul class="dropdown-menu dropdown-menu-right">
								          	<!-- data-ng-click="toggleEdit(list)" -->
								            <li><a data-ng-click="openEditListItem(item)" data-toggle="modal" data-target="#editListItemForm">Edit</a></li>
								            <li role="separator" class="divider"></li>
								            <li><a href="javascript:;" data-ng-click="deleteListItem(item._id)">Delete</a></li>
								          </ul>
								     </div>
								</td>
							</tr>
						</table>
						</li>
					</ul>
				</div>
				</div>
			</div>
		
			<div class="panel-footer">
			    <table width="100%">
				<tr>
				<td width="4%"><span class="glyphicon glyphicon-tags">&nbsp;</span></td>
				<td width="100%"><tags-input placeholder="tags" ng-model="list.ngTags" 
							maxTags="4"
                            on-tag-added="tagAdded($tag)"
                            on-tag-removed="tagRemoved($tag)">
				</tags-input></td>
				</tr>
				</table>
			</div>
		</div>
	  </div>
</div>

<!-- Add List Modal -->
<div id="addListForm" class="modal fade" role="dialog" my-modal>
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Add List</h4>
      </div>
      <div class="modal-body">
        <form name="addListForm" role="form" novalidate>
				<div class="form-group">
						<!-- NAME -->
						<input name="title" type="text" class="form-control input-md" placeholder="Title" data-ng-model="formData.title" ng-minlength="4" ng-maxlength="50" required>
					    <small class="error" 
					        ng-show="addListForm.title.$dirty && addListForm.title.$error.required">
					        Title is required.</small>
					    </small>
					    <small class="error" 
					            ng-show="addListForm.title.$error.minlength">
					            Title is required to be at least 4 characters
					    </small>
					    <small class="error" 
					            ng-show="addListForm.title.$error.maxlength">
					            Title cannot be longer than 50 characters
					    </small>
				</div>
				<div class="form-group">
					<textarea name="description" class="form-control" rows="2" id="comment" data-ng-model="formData.description" placeholder="Description" ng-maxlength="140"></textarea>
					<small class="error" 
					            ng-show="addListForm.description.$error.maxlength">
					            Description cannot be longer than 140 characters
					    </small>
				</div>
		</form>
      </div>
      <div class="modal-footer">
      	<table width="100%">
      		<tr>
      			<td align="right" width="100%">
      				<button type="submit" class="btn btn-success btn-md" ng-disabled="addListForm.$invalid" ng-click="createList()">Add</button>
      			</td>
      			<td align="right" style="padding-left: 10px;">
      				<button type="button" class="btn btn-default" data-dismiss="modal" ng-click="closeList()">Cancel</button>
      			</td>
      		</tr>
      	</table>	
      </div>
    </div>

  </div>
</div>

<!--Edit List Modal -->
<div id="editListForm" class="modal fade" role="dialog" my-modal>
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Edit List</h4>
      </div>
      <div class="modal-body">
        <form name="editListForm" role="form" novalidate>
				<div class="form-group">
						<!-- NAME -->
						<input name="title" type="text" class="form-control input-md" placeholder="Title" ng-model="editList.title" ng-minlength="4" ng-maxlength="50" required>
					    <small class="error" 
					        ng-show="editListForm.title.$dirty && editListForm.title.$error.required">
					        Title is required.</small>
					    <small class="error" 
					            ng-show="editListForm.title.$error.minlength">
					            Title is required to be at least 4 characters
					    </small>
					    <small class="error" 
					            ng-show="editListForm.title.$error.maxlength">
					            Title cannot be longer than 50 characters
					    </small>
				</div>
				<div class="form-group">
					<textarea name="description" class="form-control" rows="2" id="comment" ng-model="editList.description" placeholder="Description" ng-maxlength="140"></textarea>
					<small class="error" 
					            ng-show="editListForm.description.$error.maxlength">
					            Description cannot be longer than 140 characters
					    </small>
				</div>
		</form>
      </div>
      <div class="modal-footer">
      	<table width="100%">
      		<tr>
      			<td align="right" width="100%">
      				<button type="submit" class="btn btn-success btn-md" ng-disabled="editListForm.$invalid" ng-click="saveList()">Save</button>
      			</td>
      			<td align="right" style="padding-left: 10px;">
      				<button type="button" class="btn btn-default" data-dismiss="modal" ng-click="closeList()">Cancel</button>
      			</td>
      		</tr>
      	</table>	
      </div>
    </div>

  </div>
</div>

<!--Edit ListItem Modal -->
<div id="editListItemForm" class="modal fade" role="dialog" my-modal>
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Edit List Item</h4>
      </div>
      <div class="modal-body">
        <form name="editListItemForm" role="form" novalidate>
				<div class="form-group">
						<!-- title -->
						<input name="title" type="text" class="form-control input-md" placeholder="Title" ng-model="editListItem.title" ng-minlength="4" ng-maxlength="50" required>
					    <small class="error" 
					        ng-show="editListitemForm.title.$dirty && editListItemForm.title.$error.required">
					        Title is required.</small>
					    <small class="error" 
					            ng-show="editListItemForm.title.$error.minlength">
					            Title is required to be at least 4 characters
					    </small>
					    <small class="error" 
					            ng-show="editListItemForm.title.$error.maxlength">
					            Title cannot be longer than 50 characters
					    </small>
				</div>
				<div class="form-group">
					<textarea name="description" class="form-control" rows="2" id="comment" ng-model="editListItem.description" placeholder="Description" ng-maxlength="140"></textarea>
					<small class="error" 
					            ng-show="editListItemForm.description.$error.maxlength">
					            Description cannot be longer than 140 characters
					    </small>
				</div>
				<div class="form-group">
						<!-- url -->
						<input name="url" type="text" class="form-control input-md" placeholder="Url" ng-model="editListItem.url" ng-minlength="4" ng-maxlength="50">
					    <small class="error" 
					            ng-show="editListItemForm.url.$error.minlength">
					            Url is required to be at least 4 characters
					    </small>
					    <small class="error" 
					            ng-show="editListItemForm.url.$error.maxlength">
					            Url cannot be longer than 50 characters
					    </small>
				</div>
		</form>
      </div>
      <div class="modal-footer">
      	<table width="100%">
      		<tr>
      			<td align="right" width="100%">
      				<button type="submit" class="btn btn-success btn-md" ng-disabled="editListItemForm.$invalid" ng-click="saveListItem()">Save</button>
      			</td>
      			<td align="right" style="padding-left: 10px;">
      				<button type="button" class="btn btn-default" data-dismiss="modal" ng-click="closeListItem()">Cancel</button>
      			</td>
      		</tr>
      	</table>	
      </div>
    </div>

  </div>
</div>


</div>
<footer class="footer">
      <div class="container">
        <p class="text-muted">Alex Ershov - 2015</p>
      </div>
    </footer>
</body>
</html>